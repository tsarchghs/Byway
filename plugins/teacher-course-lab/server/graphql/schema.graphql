# GraphQL schema for teacher-course-lab plugin
type LabChallenge {
  id: ID!
  title: String!
  slug: String!
  description: String!
  difficulty: String!
  starterRepoUrl: String
  testsRepoUrl: String
  runtime: String
  createdByUserId: String!
  visibility: String!
  createdAt: String!
  updatedAt: String!
}

type LabSession {
  id: ID!
  userId: String!
  challengeId: ID!
  status: String!
  codeServerUrl: String
  codeServerToken: String
  containerId: String
  lastHeartbeat: String
  createdAt: String!
  updatedAt: String!
  challenge: LabChallenge!
}

type Submission {
  id: ID!
  sessionId: ID!
  status: String!
  passed: Boolean!
  gradePct: Float
  feedback: String
  artifactsUrl: String
  createdAt: String!
  updatedAt: String!
}

type Query {
  tclab_challenges(search: String): [LabChallenge!]!
  tclab_challengeBySlug(slug: String!): LabChallenge
  tclab_sessionsByUser(userId: String!): [LabSession!]!
  tclab_session(id: ID!): LabSession
  tclab_submissions(sessionId: ID!): [Submission!]!
}

input NewChallengeInput {
  title: String!
  slug: String!
  description: String!
  difficulty: String!
  starterRepoUrl: String
  testsRepoUrl: String
  runtime: String
  visibility: String
}

input StartSessionInput {
  challengeId: ID!
  userId: String!
}

input SubmitSessionInput {
  sessionId: ID!
}

type Mutation {
  tclab_createChallenge(input: NewChallengeInput!): LabChallenge!
  tclab_startSession(input: StartSessionInput!): LabSession!
  tclab_stopSession(id: ID!): LabSession!
  tclab_submit(input: SubmitSessionInput!): Submission!
}
