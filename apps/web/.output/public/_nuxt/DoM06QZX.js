import{g as k,r as p,l as v,k as w,c as I,b as s,w as i,n as S,p as n,o as u,q as _,a as t,d as b}from"./DQDUwbr-.js";const A={class:"p-4"},L=k({__name:"index",setup(C){const o=p(!1),d=p([]),h=[{title:"Challenge",dataIndex:["challenge","title"],key:"challenge"},{title:"Status",dataIndex:"status",key:"status"},{title:"Last Result",dataIndex:["lastSubmission","status"],key:"lastStatus"},{title:"Grade %",dataIndex:["lastSubmission","gradePct"],key:"gradePct"},{title:"Attempts",dataIndex:"attempts",key:"attempts"},{title:"Course Binding",dataIndex:"binding",key:"binding"},{title:"Started",dataIndex:"createdAtFormatted",key:"createdAt"}];async function y(){o.value=!0;try{const a=await fetch("/api/teacher-course-lab/sessions/me"),l=await a.json();if(!a.ok)throw new Error(l?.error||"Failed to load lab sessions");d.value=(l.sessions||[]).map(e=>{const c=e.submissions&&e.submissions[0]||null,r=e.challenge||{};return{...e,lastSubmission:c,attempts:e.submissions?e.submissions.length:0,binding:[r.courseId,r.moduleId,r.lessonId].filter(Boolean).join(" / "),createdAtFormatted:e.createdAt?new Date(e.createdAt).toLocaleString():""}})}catch(a){console.error(a),S.error(a?.message||"Failed to load lab sessions")}finally{o.value=!1}}const f=v(()=>d.value.length>0);return w(y),(a,l)=>{const e=n("a-page-header"),c=n("a-empty"),r=n("a-table"),m=n("a-card"),g=n("a-col"),x=n("a-row");return u(),I("div",A,[s(e,{title:"My Labs & Projects","sub-title":"CS50-style labs connected to your courses and modules"}),s(x,{gutter:16},{default:i(()=>[s(g,{xs:24,md:15},{default:i(()=>[s(m,{title:"Lab sessions",loading:o.value},{default:i(()=>[!o.value&&!f.value?(u(),_(c,{key:0,description:"No lab sessions yet. Ask your teacher for a challenge ID."})):(u(),_(r,{key:1,columns:h,"data-source":d.value,loading:o.value,size:"small","row-key":"id"},null,8,["data-source","loading"]))]),_:1},8,["loading"])]),_:1}),s(g,{xs:24,md:9},{default:i(()=>[s(m,{title:"How labs work"},{default:i(()=>[...l[0]||(l[0]=[t("p",{class:"text-sm text-gray-600 mb-2"},[b(" Labs run in a dedicated code-server instance, managed by the "),t("strong",null,"teacher-course-lab"),b(" plugin. ")],-1),t("ul",{class:"text-sm text-gray-700 mb-2"},[t("li",null,"1. Your teacher gives you a challenge ID."),t("li",null,"2. You start a session from the labs page in the platform."),t("li",null,"3. Code, run tests, and submit your work.")],-1),t("p",{class:"text-xs text-gray-500"}," This page reuses the teacher-course-lab plugin through its public REST API and keeps everything student-facing in the students-internal plugin. ",-1)])]),_:1})]),_:1})]),_:1})])}}});export{L as default};
