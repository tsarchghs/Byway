import{g as zt,U as Lt,ar as Nt,W as Bt,r as v,l as i,ad as E,k as Ut,c as _,b as n,w as s,a as l,t as o,d as p,x as I,q as y,K as Q,I as A,J as D,L as ce,p as u,aC as pe,D as Xe,T as Ye,aD as Ze,aE as Ae,az as et,B as tt,C as Se,aF as at,o as r,aA as jt,z as nt,n as Te,_ as Et}from"./DQDUwbr-.js";import{u as Kt}from"./CI-SnmTa.js";const Vt={key:0,class:"portal-state portal-state--loading"},Pt={key:1,class:"portal-state"},Gt={key:2,class:"portal-state"},Ft={key:3,class:"portal-shell"},Ht={class:"portal-hero"},Jt={class:"portal-hero__left"},Wt={class:"hero-subtitle"},Qt={class:"hero-meta"},Xt={class:"portal-hero__right"},Yt=["href"],Zt=["href"],ea=["href"],ta=["href"],aa=["href"],na=["href"],la=["href"],sa={class:"hero-controls"},oa={class:"hero-actions"},ia={class:"hero-updated"},ra={class:"role-narrative"},ua={class:"role-narrative__copy"},da={class:"role-narrative__badge"},ca={class:"role-narrative__helper"},pa={class:"role-narrative__spotlights"},ma={class:"spotlight-card__icon"},va={class:"spotlight-card__content"},_a={class:"spotlight-card__title"},ha={class:"spotlight-card__detail"},fa={class:"spotlight-card__metric"},ga={class:"stat-grid","aria-label":"Key indicators"},ya={class:"stat-icon"},ba={class:"stat-label"},ka={class:"stat-value"},wa={class:"stat-hint"},Ca={class:"role-tabs","aria-label":"Role specific focus"},$a={class:"lanes-grid"},Ia={class:"role-lane__badge"},Aa=["data-status"],Sa={class:"role-lane__badge"},Ta={class:"metric-pill metric-pill--accent"},Da={class:"role-lane__badge"},Ma=["data-status"],Oa={class:"timeline-title"},xa={class:"timeline-description"},Ra={class:"timeline-metric"},qa={class:"metric-pill metric-pill--accent"},za={class:"table-sub"},La={class:"metric-pill metric-pill--accent"},Na={class:"course-list"},Ba={class:"course-name"},Ua={class:"course-meta"},ja={class:"timeline-title"},Ea={class:"timeline-description"},Ka={class:"timeline-metric"},Va={class:"progress-grid"},Pa={class:"progress-label"},Ga={class:"progress-helper"},Fa=["data-status"],Ha={class:"important-dates"},Ja={class:"date-label"},Wa={class:"date-helper"},Qa=["data-status"],Xa={class:"ops-grid","aria-label":"Operations"},Ya={class:"timeline-title"},Za={class:"timeline-description"},en={class:"timeline-meta"},tn={class:"membership-grid"},an={class:"membership-value"},nn={class:"membership-value"},ln={class:"membership-value"},sn={class:"drawer-meta"},on={class:"drawer-section"},rn={class:"action-label"},un={class:"action-helper"},dn=zt({__name:"inst-portal-role-based",setup(cn){const z=Lt(),De=Nt(),Me=Bt(),X=Me.public?.apiBase||Me.public?.appBaseUrl||"",{me:Oe}=Kt(),xe=v(!1),Re=v(null),L=v([]),me=v([]),qe=v([]),ze=v([]),K=v([]),Y=v(!0),V=v(null),Le=v("never"),P=v("auto"),C=v("overview"),G=v(!1),k=v("none"),lt=v(null),w=v(null),Z=v(!1),ee=v(!1),ve=v("department"),M=v({name:"",owner:"",note:""});function _e(){const t=Re.value||(typeof window<"u"?localStorage.getItem("token")||localStorage.getItem("access_token"):"");return t?t.startsWith("Bearer")?t:`Bearer ${t}`:null}const st=[{label:"Auto (based on role)",value:"auto"},{label:"Administrators",value:"admin"},{label:"Teachers",value:"teacher"},{label:"Students",value:"student"}],ot=i(()=>G.value?"theme-dark":"theme-light"),F=v(""),it=()=>{const t=z.params?.institution_id;if(Array.isArray(t))return t[0];if(typeof t=="string")return t;const e=z.query?.institution_id;return Array.isArray(e)?e[0]:typeof e=="string"?e:""},Ne=i(()=>z.query.institutionId||F.value||"inst_byway");function N(t){const e=`?institutionId=${encodeURIComponent(Ne.value)}`;return t==="overview"?`/institution/portal${e}`:t==="departments"?`/institution/departments/${e}`:t==="classrooms"?`/institution/classrooms/${e}`:t==="people"?`/institution/people${e}`:t==="catalog"?`/institution/catalog${e}`:t==="calendar"?`/institution/calendar${e}`:t==="assignments"?`/institution/assignments/teachers${e}`:`/institution/portal${e}`}E(()=>[z.params?.institution_id,z.query?.institution_id],()=>{F.value=it()},{immediate:!0});const f=i(()=>L.value.length===0?null:F.value?L.value.find(t=>t.id===F.value||t.slug===F.value)||L.value[0]||null:L.value[0]||null),O=i(()=>f.value?me.value.filter(t=>t.institutionId===f.value.id):[]),m=i(()=>f.value?qe.value.filter(t=>t.institutionId===f.value.id):[]),B=i(()=>f.value?ze.value.filter(t=>t.institutionId===f.value.id):[]),H=i(()=>B.value.filter(t=>/admin/i.test(t.role))),te=i(()=>B.value.filter(t=>/teach/i.test(t.role))),ae=i(()=>B.value.filter(t=>/student/i.test(t.role))),rt=i(()=>Oe.value&&B.value.find(t=>t.userId===Oe.value.id)||null),ut=i(()=>{if(P.value!=="auto")return P.value;if(k.value==="admin"||k.value==="teacher"||k.value==="student")return k.value;const t=rt.value?.role?.toLowerCase();return t?.includes("admin")?"admin":t?.includes("teach")?"teacher":(t?.includes("student"),"student")}),S=i(()=>ut.value),ne=i(()=>S.value==="admin"),Be=i(()=>S.value==="teacher"),Ue=i(()=>S.value==="student"),dt=i(()=>{if(!f.value)return"";const t=O.value.length,e=m.value.length;return`Live institution workspace with ${t} departments and ${e} classrooms mapped to Teach.`}),ct=i(()=>({admin:"Viewing as Administrator",teacher:"Viewing as Teacher",student:"Viewing as Student"})[S.value]),pt=i(()=>{const t=O.value.length,e=m.value.length,c=m.value.filter(x=>x.status!=="archived").length,d=B.value.length,g=te.value.length,b=m.value.length?Math.round(m.value.reduce((x,ue)=>x+(ue.capacity||0),0)/m.value.length):0;return[{id:"departments",label:"Departments",value:`${t}`,hint:`${t?"Mapped":"Pending mapping"} for ${f.value?.name||""}`,icon:pe},{id:"classrooms",label:"Classrooms",value:`${e}`,hint:`${c} active, ${e-c} in draft`,icon:Xe},{id:"members",label:"Memberships",value:`${d}`,hint:`${g} teachers, ${ae.value.length} learners`,icon:Ye},{id:"capacity",label:"Avg Capacity",value:`${b}`,hint:"Seats per classroom",icon:Ze}]}),U=i(()=>{const t={};return me.value.forEach(e=>{t[e.id]=e}),t}),je=i(()=>{const t={};return m.value.forEach(e=>{e.departmentId&&(t[e.departmentId]=(t[e.departmentId]||0)+1)}),t}),Ee=i(()=>{const t=O.value.filter(b=>b.active!==!1).length,e=Math.max(1,O.value.length),c=`${Math.round(t/e*100)}%`,d=`${m.value.filter(b=>b.status==="active").length} active`,g=`${H.value.length} admins`;return[{id:"governance",label:"Governance coverage",metric:c,detail:"Departments with active governance owners",status:t===e?"good":"watch"},{id:"rooms",label:"Classroom readiness",metric:d,detail:"Rooms mapped to Teach-internal",status:m.value.length>0?"good":"watch"},{id:"membership",label:"Administrator presence",metric:g,detail:"People with admin role at this institution",status:H.value.length>0?"good":"watch"}]}),le=i(()=>m.value.slice(0,6).map((t,e)=>({id:t.id,title:t.title||t.code,description:`${U.value[t.departmentId||""]?.name||"General studies"} · ${t.capacity||0} seats`,timeline:`Week ${e+1}`,classroom:t}))),mt=i(()=>m.value.map(t=>({...t,departmentName:U.value[t.departmentId||""]?.name||"General studies"}))),J=i(()=>m.value.length===0?[{id:"no-classrooms",title:"No classrooms linked yet",description:"Connect Teach classrooms to surface student journeys.",helper:"Setup required",status:"warn"}]:m.value.slice(0,5).map((t,e)=>({id:`student-${t.id}`,title:t.title||`Learning lane ${e+1}`,description:`Code ${t.code} · ${U.value[t.departmentId||""]?.name||"General"}`,helper:`${t.enrollmentCount??0} enrolled`,status:t.enrollmentCount&&t.enrollmentCount>(t.capacity||0)?"warn":"good"}))),se=i(()=>{const t=m.value.length;return[{id:"attendance",label:"Attendance",helper:"Based on classroom check-ins",percent:Math.min(100,60+t*5)},{id:"assignments",label:"Assignments on track",helper:"Teach-internal mirrored tasks",percent:Math.min(100,55+t*4)},{id:"labs",label:"Lab readiness",helper:"Hands-on modules",percent:Math.min(100,40+t*3)}]}),Ke=i(()=>W.value.slice(0,4)),W=i(()=>m.value.slice(0,6).map((t,e)=>({id:t.id,title:t.title||t.code,description:`${U.value[t.departmentId||""]?.name||"General"} · Capacity ${t.capacity||0}`,date:xe.value?new Date(Date.now()+e*864e5).toLocaleDateString():`Day ${e+1}`,color:t.status==="active"?"green":"blue"}))),Ve=i(()=>{const t=m.value.reduce((c,d)=>c+(d.capacity||0),0),e=m.value.reduce((c,d)=>c+(d.enrollmentCount||0),0);return t?Math.round(e/t*100):0}),oe=i(()=>K.value.length>0?K.value.filter(t=>!f.value||!t.institutionId||t.institutionId===f.value.id):le.value.slice(0,3).map(t=>({id:t.id,title:t.title,category:U.value[t.classroom?.departmentId||""]?.name||"Integrated program",difficulty:t.timeline}))),vt=i(()=>w.value?[{id:"sync",label:"Sync attendance from Teach-internal",detail:"Ensure live roster is mirrored for gradebook accuracy."},{id:"assign",label:"Assign secondary facilitator",detail:"Add a co-teacher for resilience across lab sessions."},{id:"students",label:"Audit student roster",detail:"Verify enrollments vs Byway membership records."}]:[]),ie=i(()=>{switch(S.value){case"admin":return{badge:"Administrator view",title:"Keep governance resilient",description:"Track institution readiness, unlock department blueprints, and enforce compliance without leaving this workspace.",helper:"Auto-linked membership data keeps leadership heatmaps accurate."};case"teacher":return{badge:"Teacher view",title:"Orchestrate the learning runway",description:"Line up classrooms, review mission queues, and keep Teach-internal courses in sync with institutional targets.",helper:"Classrooms and courses mirror Teach IDs so transitions stay seamless."};default:return{badge:"Student view",title:"Mentor every learner journey",description:"Surface advisory nudges, track engagement, and highlight upcoming milestones across the institution.",helper:"Signals adapt based on classroom enrollment and real-time mock data."}}}),_t=i(()=>S.value==="admin"?[{id:"coverage",title:"Role coverage",detail:`${H.value.length} admins vs ${te.value.length} faculty`,metric:`${Ve.value}% util`,icon:Ae},{id:"departments",title:"Departments mapped",detail:`${O.value.length} total units`,metric:`${Object.keys(je.value).length} active`,icon:et},{id:"classrooms",title:"Rooms ready",detail:`${m.value.filter(e=>e.status==="active").length} active`,metric:`${m.value.length} total`,icon:pe}]:S.value==="teacher"?[{id:"missions",title:"Missions queued",detail:"Classrooms needing focus this sprint",metric:`${le.value.length}`,icon:tt},{id:"courses",title:"Courses linked",detail:"Teach-internal courses synced",metric:`${oe.value.length}`,icon:Xe},{id:"timeline",title:"Timeline readiness",detail:"Upcoming classroom checkpoints",metric:`${W.value.length}`,icon:Se}]:[{id:"engagement",title:"Engagement index",detail:"Attendance and assignments on track",metric:`${se.value.length?Math.round(se.value.reduce((e,c)=>e+c.percent,0)/se.value.length):0}%`,icon:at},{id:"advisory",title:"Advisory signals",detail:`${J.value.length} active nudges`,metric:`${ae.value.length} learners`,icon:Ze},{id:"calendar",title:"Upcoming checkpoints",detail:"Next cohort events",metric:`${Ke.value.length}`,icon:Se}]),ht=i(()=>{const t=O.value.filter(c=>c.active===!1).length,e=m.value.filter(c=>c.status!=="active").length;return[{id:"dept-audit",label:"Activate departments",description:`${t} departments awaiting activation`,owner:"Governance"},{id:"classroom-readiness",label:"Review classroom readiness",description:`${e} rooms pending launch`,owner:"Academic ops"},{id:"membership-review",label:"Audit memberships",description:`${B.value.length} total memberships`,owner:"HR coordination"}]}),ft=i(()=>(W.value.length?W.value:J.value).slice(0,4).map((t,e)=>({...t,slot:`Block ${e+1}`}))),gt=i(()=>J.value.map((t,e)=>({id:t.id,label:`Action ${e+1}`,description:t.description,helper:t.helper,status:t.status}))),yt=t=>({onClick:()=>ge(t)}),he={admin:"administrators",teacher:"teachers",student:"students"};function fe(t){P.value=t,t==="auto"?C.value=he[S.value]||"overview":C.value=he[t]||"overview"}function ge(t){w.value=t,Z.value=!0}function bt(){Pe()}function re(t){ve.value=t,M.value={name:"",owner:"",note:""},ee.value=!0}const kt=i(()=>ve.value==="department"?"New department blueprint":"New classroom shell");function wt(){if(!M.value.name?.trim()){Te.error("Name is required");return}const t=ve.value==="department"?"Department":"Classroom";Te.success(`${t} plan saved locally`),ee.value=!1}function Ct(){C.value="teachers"}function ye(t){Te.info(`Mock action triggered for ${t}`)}function $t(){if(L.value.length===0)return;const t=L.value[0];De.replace({path:`/institution/${t.id}`})}async function Pe(){const t=_e();if(!t){V.value="Missing auth token",Y.value=!1;return}const e=`${X}/api/institution-portal/overview`;Y.value=!0,V.value=null;try{const c=await fetch(e,{method:"GET",headers:{"content-type":"application/json",Authorization:t}});if(!c.ok)throw new Error(`HTTP ${c.status}`);const d=await c.json();L.value=d.institutions||[],me.value=d.departments||[],qe.value=(d.classrooms||[]).map(g=>({...g,enrollmentCount:g.enrollments?.length??g.enrollment??g.enrollmentCount??null})),ze.value=d.members||[],await It(),Le.value=new Date().toLocaleString()}catch(c){console.warn("[institutions-portal] overview failed",c),V.value=c?.message||"Failed to load overview"}finally{Y.value=!1}}async function It(){K.value=[];const t=_e();if(t)try{const e=await fetch(`${X}/api/teach-internal/graphql`,{method:"POST",headers:{"content-type":"application/json",Authorization:t},body:JSON.stringify({query:`
          query MyCourses {
            myCourses {
              id
              title
              difficulty
              category
              institutionId
            }
          }
        `})});if(!e.ok)throw new Error(`HTTP ${e.status}`);const d=(await e.json())?.data?.myCourses;K.value=Array.isArray(d)?d:[]}catch(e){console.warn("[institutions-portal] teacher courses fallback",e),K.value=[]}}E(()=>S.value,t=>{P.value==="auto"&&(C.value=he[t]||"overview")},{immediate:!0}),E(()=>z.query.role,t=>{(t==="admin"||t==="teacher"||t==="student")&&fe(t)}),E(()=>G.value,t=>{typeof window<"u"&&window.localStorage.setItem("inst-portal-theme",t?"dark":"light")}),E(f,()=>{w.value=null,Z.value=!1}),Ut(()=>{if(typeof window<"u"){G.value=window.localStorage.getItem("inst-portal-theme")==="dark",Re.value=localStorage.getItem("token")||localStorage.getItem("access_token");const t=z.query.role;(t==="admin"||t==="teacher"||t==="student")&&fe(t)}xe.value=!0,Pe(),At()});async function At(){try{const t=_e();if(!t){k.value="none";return}const e=X?X.replace(/\/$/,""):"",g=(await(await fetch(`${e}/api/authentication/graphql`,{method:"POST",headers:{"content-type":"application/json",Authorization:t},body:JSON.stringify({query:"query Me { me { id } }"})})).json().catch(()=>null))?.data?.me?.id||null;if(lt.value=g,!g){k.value="none";return}const x=await(await fetch(`${e}/api/institutions/graphql`,{method:"POST",headers:{"content-type":"application/json",Authorization:t},body:JSON.stringify({query:"query($institutionId:String!){ members(institutionId:$institutionId){ userId role } }",variables:{institutionId:Ne.value}})})).json().catch(()=>null),be=(Array.isArray(x?.data?.members)?x.data.members:[]).find($=>$.userId===g),h=String(be?.role||"").toLowerCase();h.includes("admin")?k.value="admin":h.includes("teach")?k.value="teacher":h.includes("student")?k.value="student":k.value="none"}catch{k.value="none"}}return E(k,t=>{t==="none"&&De.replace({path:"/institution/join"})}),(t,e)=>{const c=u("a-spin"),d=u("a-button"),g=u("a-result"),b=u("a-menu-item"),x=u("a-menu"),ue=u("a-switch"),be=u("a-select"),h=u("a-card"),$=u("a-list-item-meta"),R=u("a-list-item"),q=u("a-list"),de=u("a-tab-pane"),ke=u("a-timeline-item"),we=u("a-timeline"),j=u("a-col"),T=u("a-table-column"),Ge=u("a-tag"),Fe=u("a-table"),St=u("a-space"),Ce=u("a-row"),He=u("a-divider"),Je=u("a-progress"),Tt=u("a-tabs"),We=u("a-empty"),$e=u("a-descriptions-item"),Dt=u("a-descriptions"),Mt=u("a-drawer"),Qe=u("a-input"),Ie=u("a-form-item"),Ot=u("a-textarea"),xt=u("a-form"),Rt=u("a-modal");return r(),_("div",{class:ce(["institution-role-portal",ot.value])},[Y.value?(r(),_("div",Vt,[n(c,{tip:"Synchronizing institution insights..."})])):V.value?(r(),_("div",Pt,[n(g,{status:"warning",title:"Unable to load institution portal","sub-title":V.value},{extra:s(()=>[n(d,{type:"primary",onClick:bt},{default:s(()=>[n(I(jt)),e[18]||(e[18]=p(" Try again ",-1))]),_:1})]),_:1},8,["sub-title"])])):f.value?(r(),_("div",Ft,[l("header",Ht,[l("div",Jt,[e[20]||(e[20]=l("p",{class:"eyebrow"},"Institution control room",-1)),l("h1",null,o(f.value.name),1),l("p",Wt,o(dt.value),1),l("ul",Qt,[l("li",null,[n(I(Ye)),p(" "+o(f.value.type||"Comprehensive campus")+" · "+o(f.value.location||"Location TBC"),1)]),l("li",null,[n(I(pe)),p(" "+o(O.value.length)+" departments · "+o(m.value.length)+" classrooms ",1)]),l("li",null,[n(I(Ae)),p(" "+o(ct.value),1)])])]),l("div",Xt,[n(x,{mode:"horizontal",selectedKeys:["overview"],style:{"margin-bottom":"12px"}},{default:s(()=>[n(b,{key:"overview"},{default:s(()=>[l("a",{href:N("overview")},"Overview",8,Yt)]),_:1}),ne.value?(r(),y(b,{key:"departments"},{default:s(()=>[l("a",{href:N("departments")},"Departments",8,Zt)]),_:1})):Q("",!0),n(b,{key:"classrooms"},{default:s(()=>[l("a",{href:N("classrooms")},"Classrooms",8,ea)]),_:1}),n(b,{key:"people"},{default:s(()=>[l("a",{href:N("people")},"People Directory",8,ta)]),_:1}),n(b,{key:"catalog"},{default:s(()=>[l("a",{href:N("catalog")},"Catalog",8,aa)]),_:1}),n(b,{key:"calendar"},{default:s(()=>[l("a",{href:N("calendar")},"Calendar",8,na)]),_:1}),n(b,{key:"assignments"},{default:s(()=>[l("a",{href:N("assignments")},"Assignments",8,la)]),_:1})]),_:1}),l("div",sa,[n(ue,{checked:G.value,"onUpdate:checked":e[0]||(e[0]=a=>G.value=a),"checked-children":"Dark","un-checked-children":"Light"},null,8,["checked"]),n(be,{class:"role-select",value:P.value,style:{width:"200px"},options:st,onChange:fe},null,8,["value"])]),l("div",oa,[ne.value?(r(),y(d,{key:0,type:"primary",onClick:e[1]||(e[1]=a=>re("department"))},{default:s(()=>[n(I(et)),e[21]||(e[21]=p(" New department plan ",-1))]),_:1})):Q("",!0),ne.value?(r(),y(d,{key:1,onClick:e[2]||(e[2]=a=>re("classroom"))},{default:s(()=>[n(I(pe)),e[22]||(e[22]=p(" Add classroom shell ",-1))]),_:1})):Q("",!0),Be.value?(r(),y(d,{key:2,onClick:Ct},{default:s(()=>[n(I(tt)),e[23]||(e[23]=p(" Teaching playbook ",-1))]),_:1})):Q("",!0),Ue.value?(r(),y(d,{key:3,onClick:e[3]||(e[3]=a=>C.value="students")},{default:s(()=>[n(I(at)),e[24]||(e[24]=p(" Learner spotlight ",-1))]),_:1})):Q("",!0)]),l("p",ia,"Last synced: "+o(Le.value),1)])]),l("section",ra,[l("div",ua,[l("p",da,o(ie.value.badge),1),l("h2",null,o(ie.value.title),1),l("p",null,o(ie.value.description),1),l("p",ca,o(ie.value.helper),1)]),l("div",pa,[(r(!0),_(A,null,D(_t.value,a=>(r(),y(h,{key:a.id,class:"spotlight-card",bordered:!1},{default:s(()=>[l("div",ma,[(r(),y(nt(a.icon)))]),l("div",va,[l("p",_a,o(a.title),1),l("p",ha,o(a.detail),1)]),l("p",fa,o(a.metric),1)]),_:2},1024))),128))])]),l("section",ga,[(r(!0),_(A,null,D(pt.value,a=>(r(),y(h,{key:a.id,class:"stat-card",bordered:!1},{default:s(()=>[l("div",ya,[(r(),y(nt(a.icon)))]),l("div",null,[l("p",ba,o(a?.label),1),l("p",ka,o(a?.value),1),l("p",wa,o(a?.hint),1)])]),_:2},1024))),128))]),l("section",Ca,[n(Tt,{activeKey:C.value,"onUpdate:activeKey":e[11]||(e[11]=a=>C.value=a)},{default:s(()=>[n(de,{key:"overview",tab:"Unified overview"},{default:s(()=>[l("div",$a,[l("article",{class:ce(["role-lane",{"role-lane--highlight":ne.value}])},[l("header",null,[e[25]||(e[25]=l("div",null,[l("p",{class:"role-lane__eyebrow"},"Administrators"),l("h3",null,"Operational guardrails")],-1)),l("span",Ia,o(H.value.length)+" leads",1)]),n(q,{"data-source":Ee.value,split:!1},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",{class:"metric-pill","data-status":a.status},o(a.metric),9,Aa)]),default:s(()=>[n($,{title:a.label,description:a.detail},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"]),l("footer",null,[n(d,{type:"link",onClick:e[4]||(e[4]=a=>C.value="administrators")},{default:s(()=>[...e[26]||(e[26]=[p(" Open administrator workspace ",-1)])]),_:1})])],2),l("article",{class:ce(["role-lane",{"role-lane--highlight":Be.value}])},[l("header",null,[e[27]||(e[27]=l("div",null,[l("p",{class:"role-lane__eyebrow"},"Teachers"),l("h3",null,"Instruction playbooks")],-1)),l("span",Sa,o(te.value.length)+" faculty",1)]),n(q,{"data-source":le.value,split:!1},{renderItem:s(({item:a})=>[n(R,{onClick:qt=>a.classroom&&ge(a.classroom)},{actions:s(()=>[l("span",Ta,o(a.timeline),1)]),default:s(()=>[n($,{title:a.title,description:a.description},null,8,["title","description"])]),_:2},1032,["onClick"])]),_:1},8,["data-source"]),l("footer",null,[n(d,{type:"link",onClick:e[5]||(e[5]=a=>C.value="teachers")},{default:s(()=>[...e[28]||(e[28]=[p(" Open teaching workspace ",-1)])]),_:1})])],2),l("article",{class:ce(["role-lane",{"role-lane--highlight":Ue.value}])},[l("header",null,[e[29]||(e[29]=l("div",null,[l("p",{class:"role-lane__eyebrow"},"Students"),l("h3",null,"Learning guidance")],-1)),l("span",Da,o(ae.value.length)+" learners",1)]),n(q,{"data-source":J.value,split:!1},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",{class:"metric-pill","data-status":a.status},o(a.helper),9,Ma)]),default:s(()=>[n($,{title:a.title,description:a.description},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"]),l("footer",null,[n(d,{type:"link",onClick:e[6]||(e[6]=a=>C.value="students")},{default:s(()=>[...e[30]||(e[30]=[p(" Open learner workspace ",-1)])]),_:1})])],2)])]),_:1}),n(de,{key:"administrators",tab:"Administrator cockpit"},{default:s(()=>[n(Ce,{gutter:16},{default:s(()=>[n(j,{xs:24,md:10},{default:s(()=>[n(h,{title:"Governance metrics",class:"admin-card"},{default:s(()=>[n(we,null,{default:s(()=>[(r(!0),_(A,null,D(Ee.value,a=>(r(),y(ke,{key:a.id,color:a.status==="good"?"green":"orange"},{default:s(()=>[l("p",Oa,o(a.label),1),l("p",xa,o(a.detail),1),l("p",Ra,o(a.metric),1)]),_:2},1032,["color"]))),128))]),_:1}),n(d,{block:"",type:"dashed",onClick:e[7]||(e[7]=a=>ye("compliance"))},{default:s(()=>[n(I(Ae)),e[31]||(e[31]=p(" Run compliance pulse (mock) ",-1))]),_:1})]),_:1}),n(h,{title:"Strategic queue",class:"admin-card"},{default:s(()=>[n(q,{"data-source":ht.value,size:"small",bordered:""},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",qa,o(a.owner),1)]),default:s(()=>[n($,{title:a.label,description:a.description},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"])]),_:1})]),_:1}),n(j,{xs:24,md:14},{default:s(()=>[n(h,{title:"Department operating picture",class:"admin-card"},{extra:s(()=>[n(St,null,{default:s(()=>[n(d,{type:"primary",onClick:e[8]||(e[8]=a=>re("department"))},{default:s(()=>[...e[32]||(e[32]=[p(" Create department ",-1)])]),_:1}),n(d,{onClick:e[9]||(e[9]=a=>re("classroom"))},{default:s(()=>[...e[33]||(e[33]=[p(" Create classroom ",-1)])]),_:1})]),_:1})]),default:s(()=>[n(Fe,{size:"small",dataSource:O.value,pagination:{pageSize:6},rowKey:"id"},{default:s(()=>[n(T,{key:"name",title:"Department",dataIndex:"name"}),n(T,{key:"slug",title:"Slug",dataIndex:"slug"}),n(T,{key:"classrooms",title:"Classrooms"},{default:s(({record:a})=>[p(o(je.value[a.id]||0),1)]),_:1}),n(T,{key:"status",title:"Status"},{default:s(({record:a})=>[n(Ge,{color:a.active!==!1?"green":"default"},{default:s(()=>[p(o(a.active!==!1?"Active":"Inactive"),1)]),_:2},1032,["color"])]),_:1})]),_:1},8,["dataSource"])]),_:1})]),_:1})]),_:1})]),_:1}),n(de,{key:"teachers",tab:"Teacher workspace"},{default:s(()=>[n(Ce,{gutter:16},{default:s(()=>[n(j,{xs:24,md:14},{default:s(()=>[n(h,{title:"Classrooms connected to Teach"},{default:s(()=>[n(Fe,{size:"small",dataSource:mt.value,pagination:{pageSize:6},rowKey:a=>a.id,customRow:yt},{default:s(()=>[n(T,{key:"title",title:"Classroom"},{default:s(({record:a})=>[l("div",null,[l("strong",null,o(a.title||a.code),1),l("p",za,"Code: "+o(a.code),1)])]),_:1}),n(T,{key:"dept",title:"Department"},{default:s(({record:a})=>[p(o(a.departmentName),1)]),_:1}),n(T,{key:"capacity",title:"Capacity",dataIndex:"capacity"}),n(T,{key:"enrollment",title:"Enrollment"},{default:s(({record:a})=>[p(o(a.enrollmentCount??"—"),1)]),_:1}),n(T,{key:"status",title:"Status"},{default:s(({record:a})=>[n(Ge,{color:a.status==="active"?"green":"default"},{default:s(()=>[p(o(a.status||"pending"),1)]),_:2},1032,["color"])]),_:1})]),_:1},8,["dataSource","rowKey"])]),_:1})]),_:1}),n(j,{xs:24,md:10},{default:s(()=>[n(h,{title:"Mission queue"},{default:s(()=>[n(q,{"data-source":le.value,size:"small"},{renderItem:s(({item:a})=>[n(R,{onClick:qt=>a.classroom&&ge(a.classroom)},{actions:s(()=>[l("span",La,o(a.timeline),1)]),default:s(()=>[n($,{title:a.title,description:a.description},null,8,["title","description"])]),_:2},1032,["onClick"])]),_:1},8,["data-source"]),n(He),e[34]||(e[34]=l("p",{class:"card-subtitle"},"Linked courses",-1)),l("ul",Na,[(r(!0),_(A,null,D(oe.value,a=>(r(),_("li",{key:a.id},[l("p",Ba,o(a.title),1),l("p",Ua,o(a.category||"Institution-linked")+" · "+o(a.difficulty||"Mixed level"),1)]))),128))])]),_:1}),n(h,{title:"Teaching day timeline"},{default:s(()=>[n(we,null,{default:s(()=>[(r(!0),_(A,null,D(ft.value,a=>(r(),y(ke,{key:a.id,color:"blue"},{default:s(()=>[l("p",ja,o(a.title),1),l("p",Ea,o(a.description),1),l("p",Ka,o(a.slot),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(de,{key:"students",tab:"Student workspace"},{default:s(()=>[n(Ce,{gutter:16},{default:s(()=>[n(j,{xs:24,md:10},{default:s(()=>[n(h,{title:"Engagement snapshot",class:"student-card"},{default:s(()=>[l("div",Va,[(r(!0),_(A,null,D(se.value,a=>(r(),_("div",{key:a.id,class:"progress-item"},[n(Je,{type:"circle",percent:a.percent,width:90},null,8,["percent"]),l("p",Pa,o(a.label),1),l("p",Ga,o(a.helper),1)]))),128))])]),_:1})]),_:1}),n(j,{xs:24,md:14},{default:s(()=>[n(h,{title:"Advisory feed"},{default:s(()=>[n(q,{"data-source":J.value,size:"small"},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",{class:"metric-pill","data-status":a.status},o(a.helper),9,Fa)]),default:s(()=>[n($,{title:a.title,description:a.description},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"]),n(He),e[35]||(e[35]=l("p",{class:"card-subtitle"},"Next important dates",-1)),l("ul",Ha,[(r(!0),_(A,null,D(Ke.value,a=>(r(),_("li",{key:a.id},[n(I(Se)),l("div",null,[l("p",Ja,o(a.title),1),l("p",Wa,o(a.date)+" · "+o(a.description),1)])]))),128))])]),_:1}),n(h,{title:"Action center"},{default:s(()=>[n(q,{"data-source":gt.value,size:"small",bordered:""},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",{class:"metric-pill","data-status":a.status},o(a.helper),9,Qa)]),default:s(()=>[n($,{title:a.label,description:a.description},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"]),n(d,{block:"",type:"dashed",onClick:e[10]||(e[10]=a=>ye("student-workflow"))},{default:s(()=>[...e[36]||(e[36]=[p(" Record study reflection (mock) ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["activeKey"])]),l("section",Xa,[n(h,{title:"Operational timeline"},{default:s(()=>[n(we,null,{default:s(()=>[(r(!0),_(A,null,D(W.value,a=>(r(),y(ke,{key:a.id,color:a.color},{default:s(()=>[l("p",Ya,o(a.title),1),l("p",Za,o(a.description),1),l("p",en,o(a.date),1)]),_:2},1032,["color"]))),128))]),_:1})]),_:1}),n(h,{title:"Membership mix"},{default:s(()=>[l("div",tn,[l("div",null,[e[37]||(e[37]=l("p",{class:"membership-label"},"Administrators",-1)),l("p",an,o(H.value.length),1),e[38]||(e[38]=l("p",{class:"membership-helper"},"Core governance",-1))]),l("div",null,[e[39]||(e[39]=l("p",{class:"membership-label"},"Teachers",-1)),l("p",nn,o(te.value.length),1),e[40]||(e[40]=l("p",{class:"membership-helper"},"Linked to classrooms",-1))]),l("div",null,[e[41]||(e[41]=l("p",{class:"membership-label"},"Students",-1)),l("p",ln,o(ae.value.length),1),e[42]||(e[42]=l("p",{class:"membership-helper"},"Active enrollments",-1))])]),n(Je,{percent:Ve.value,status:"active"},null,8,["percent"]),e[43]||(e[43]=l("p",{class:"membership-footnote"},"Capacity utilization across classrooms",-1))]),_:1}),n(h,{title:"Course initiatives"},{default:s(()=>[oe.value.length===0?(r(),y(We,{key:0,description:"No linked courses yet"})):(r(),y(q,{key:1,"data-source":oe.value,size:"small"},{renderItem:s(({item:a})=>[n(R,null,{actions:s(()=>[l("span",null,o(a.difficulty||"Balanced"),1)]),default:s(()=>[n($,{title:a.title,description:a.category},null,8,["title","description"])]),_:2},1024)]),_:1},8,["data-source"])),n(d,{block:"",type:"dashed",onClick:e[12]||(e[12]=a=>ye("courses"))},{default:s(()=>[...e[44]||(e[44]=[p(" Sync with Teach-internal (mock) ",-1)])]),_:1})]),_:1})]),n(Mt,{open:Z.value,"onUpdate:open":e[13]||(e[13]=a=>Z.value=a),title:w.value?.title||w.value?.code||"Classroom",placement:"right",width:"420"},{default:s(()=>[w.value?(r(),_(A,{key:0},[l("p",sn,o(w.value.code)+" · "+o(w.value.status||"pending"),1),n(Dt,{bordered:"",column:"1",size:"small"},{default:s(()=>[n($e,{label:"Department"},{default:s(()=>[p(o(U.value[w.value.departmentId||""]?.name||"Unassigned"),1)]),_:1}),n($e,{label:"Capacity"},{default:s(()=>[p(o(w.value.capacity??"—"),1)]),_:1}),n($e,{label:"Enrollment"},{default:s(()=>[p(o(w.value.enrollmentCount??"—"),1)]),_:1})]),_:1}),l("div",on,[e[45]||(e[45]=l("p",{class:"drawer-section__title"},"Recommended next steps",-1)),l("ul",null,[(r(!0),_(A,null,D(vt.value,a=>(r(),_("li",{key:a.id},[l("p",rn,o(a.label),1),l("p",un,o(a.detail),1)]))),128))])])],64)):(r(),y(We,{key:1,description:"Select a classroom from the teaching table"}))]),_:1},8,["open","title"]),n(Rt,{open:ee.value,"onUpdate:open":e[17]||(e[17]=a=>ee.value=a),title:kt.value,"ok-text":"Save","cancel-text":"Cancel",onOk:wt},{default:s(()=>[n(xt,{layout:"vertical"},{default:s(()=>[n(Ie,{label:"Name",required:""},{default:s(()=>[n(Qe,{value:M.value.name,"onUpdate:value":e[14]||(e[14]=a=>M.value.name=a)},null,8,["value"])]),_:1}),n(Ie,{label:"Owner"},{default:s(()=>[n(Qe,{value:M.value.owner,"onUpdate:value":e[15]||(e[15]=a=>M.value.owner=a)},null,8,["value"])]),_:1}),n(Ie,{label:"Notes"},{default:s(()=>[n(Ot,{value:M.value.note,"onUpdate:value":e[16]||(e[16]=a=>M.value.note=a),rows:3},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","title"])])):(r(),_("div",Gt,[n(g,{status:"404",title:"Institution not found","sub-title":"The ID in the URL does not match any institution you have access to."},{extra:s(()=>[n(d,{type:"primary",onClick:$t},{default:s(()=>[...e[19]||(e[19]=[p(" Jump to default institution ",-1)])]),_:1})]),_:1})]))],2)}}}),vn=Et(dn,[["__scopeId","data-v-80e44fc0"]]);export{vn as default};
