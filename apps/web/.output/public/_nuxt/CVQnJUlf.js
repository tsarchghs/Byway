import{H as V}from"./CN_SqyUH.js";import{u as z}from"./CI-SnmTa.js";import{g as L,l as $,r as E,b4 as Y,c as w,b as e,w as t,I as H,p as o,ak as M,o as f,a as k,d,q as G,K as j,n as _,_ as K}from"./DQDUwbr-.js";import"./Cv_gb3jg.js";import"./CLh6bXrM.js";const Q={class:"teach-container"},W={class:"hero"},X={class:"onboard"},Z={key:0},ee={key:1},ae={key:2,class:"done"},te=L({__name:"teach",setup(oe){const m=z(),h=$(()=>m.user.value),y=$(()=>m.token.value),v=$(()=>m.isLoggedIn.value),p=E(v.value?1:0),P=l=>v.value?l==="teacher"?1:l==="complete"?2:0:l==="user"?0:l==="teacher"?1:2,i=E({name:"",email:"",password:""});async function C(){try{const s=(await(await fetch("http://localhost:4000/api/authentication/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          mutation($email:String!,$password:String!,$name:String){
            register(email:$email, password:$password, firstName:$name) {
              id
              email
              firstName
              token
            }
          }
        `,variables:i.value})})).json()).data?.register;if(!s?.id)throw new Error("User registration failed");const u=s.token;m.login({token:u,user:{id:s.id,email:s.email,name:s.firstName}}),_.success("Account created! Continue to fill your teacher profile."),p.value=1}catch(l){_.error(l.message||"Account creation failed.")}}const r=E({bio:"",subjects:[],avatarUrl:"",payoutEmail:""}),q=M();Y(()=>{v.value&&h.value?.teacherProfileId&&q.push(`/teach-internal/${h.value.teacherProfileId}`)});async function N(){try{if(!y.value)throw new Error("Not authenticated.");const l=Array.isArray(r.value.subjects)?r.value.subjects.join(", "):r.value.subjects,s=await(await fetch("http://localhost:4000/api/teach/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y.value}`},body:JSON.stringify({query:`
          mutation($bio:String!,$subjects:String,$avatarUrl:String,$payoutEmail:String){
            createTeacherProfile(bio:$bio,subjects:$subjects,avatarUrl:$avatarUrl,payoutEmail:$payoutEmail){
              id
            }
          }
        `,variables:{bio:r.value.bio,subjects:l,avatarUrl:r.value.avatarUrl,payoutEmail:r.value.payoutEmail}})})).json();if(s.errors)throw new Error(s.errors[0]?.message);const u=s.data?.createTeacherProfile?.id;if(!u)throw new Error("Teacher profile ID missing.");const g=await(await fetch("http://localhost:4000/api/authentication/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y.value}`},body:JSON.stringify({query:`
          mutation($teacherProfileId:String!){
            updateUserTeacherProfile(teacherProfileId:$teacherProfileId){
              id
              teacherProfileId
            }
          }
        `,variables:{teacherProfileId:u}})})).json();if(g.errors)throw new Error(g.errors[0]?.message);m.login({token:y.value,user:{...h.value,teacherProfileId:u}}),_.success("Teacher profile created and linked successfully!"),p.value=2}catch(l){_.error(l.message||"Failed to save teacher profile.")}}function x(){const l=h.value?.id;if(!l)return _.error("Missing user.");window.location.href=`http://localhost:3000/teach-internal/${l}`}return(l,a)=>{const s=o("a-typography-title"),u=o("a-typography-paragraph"),S=o("a-col"),g=o("a-row"),U=o("a-step"),A=o("a-steps"),b=o("a-input"),c=o("a-form-item"),B=o("a-input-password"),T=o("a-button"),I=o("a-form"),F=o("a-textarea"),O=o("a-select"),R=o("a-result"),J=o("a-card"),D=o("a-layout-content");return f(),w(H,null,[e(V),e(D,{class:"teach-page"},{default:t(()=>[k("div",Q,[k("section",W,[e(g,{align:"middle",justify:"space-between",gutter:"48"},{default:t(()=>[e(S,{xs:24,md:12},{default:t(()=>[e(s,{level:1},{default:t(()=>[...a[7]||(a[7]=[d(" Become a Teacher on Byway ",-1)])]),_:1}),e(u,{type:"secondary"},{default:t(()=>[...a[8]||(a[8]=[d(" Share your knowledge, inspire learners, and grow your teaching career. ",-1)])]),_:1})]),_:1}),e(S,{xs:0,md:12},{default:t(()=>[...a[9]||(a[9]=[k("img",{alt:"Teach",class:"hero-image"},null,-1)])]),_:1})]),_:1})]),k("section",X,[e(A,{current:p.value,class:"steps",size:"small"},{default:t(()=>[v.value?j("",!0):(f(),G(U,{key:0,title:"User Account"})),e(U,{title:"Teacher Profile"}),e(U,{title:"Complete"})]),_:1},8,["current"]),e(J,{class:"form-card"},{default:t(()=>[p.value===0&&!v.value?(f(),w("div",Z,[e(s,{level:3},{default:t(()=>[...a[10]||(a[10]=[d("Create Your Account",-1)])]),_:1}),e(I,{layout:"vertical",model:i.value,onFinish:C},{default:t(()=>[e(c,{label:"Full Name",name:"name",required:""},{default:t(()=>[e(b,{value:i.value.name,"onUpdate:value":a[0]||(a[0]=n=>i.value.name=n)},null,8,["value"])]),_:1}),e(c,{label:"Email",name:"email",required:""},{default:t(()=>[e(b,{type:"email",value:i.value.email,"onUpdate:value":a[1]||(a[1]=n=>i.value.email=n)},null,8,["value"])]),_:1}),e(c,{label:"Password",name:"password",required:""},{default:t(()=>[e(B,{value:i.value.password,"onUpdate:value":a[2]||(a[2]=n=>i.value.password=n)},null,8,["value"])]),_:1}),e(T,{type:"primary","html-type":"submit",block:""},{default:t(()=>[...a[11]||(a[11]=[d("Continue",-1)])]),_:1})]),_:1},8,["model"])])):j("",!0),p.value===P("teacher")?(f(),w("div",ee,[e(s,{level:3},{default:t(()=>[...a[12]||(a[12]=[d("Your Teacher Profile",-1)])]),_:1}),e(I,{layout:"vertical",model:r.value,onFinish:N},{default:t(()=>[e(c,{label:"Bio",name:"bio",required:""},{default:t(()=>[e(F,{value:r.value.bio,"onUpdate:value":a[3]||(a[3]=n=>r.value.bio=n),rows:"3",placeholder:"Tell learners about yourself..."},null,8,["value"])]),_:1}),e(c,{label:"Subjects",name:"subjects",required:""},{default:t(()=>[e(O,{mode:"tags",placeholder:"e.g. Design, Programming, Marketing",value:r.value.subjects,"onUpdate:value":a[4]||(a[4]=n=>r.value.subjects=n)},null,8,["value"])]),_:1}),e(c,{label:"Avatar URL",name:"avatarUrl"},{default:t(()=>[e(b,{value:r.value.avatarUrl,"onUpdate:value":a[5]||(a[5]=n=>r.value.avatarUrl=n),placeholder:"https://..."},null,8,["value"])]),_:1}),e(c,{label:"Payout Email",name:"payoutEmail"},{default:t(()=>[e(b,{type:"email",value:r.value.payoutEmail,"onUpdate:value":a[6]||(a[6]=n=>r.value.payoutEmail=n),placeholder:"for receiving earnings"},null,8,["value"])]),_:1}),e(T,{type:"primary","html-type":"submit",block:""},{default:t(()=>[...a[13]||(a[13]=[d(" Save & Continue ",-1)])]),_:1})]),_:1},8,["model"])])):j("",!0),p.value===P("complete")?(f(),w("div",ae,[e(R,{status:"success",title:"You're officially a Byway Instructor!","sub-title":"Start creating your first course now."},{extra:t(()=>[e(T,{type:"primary",onClick:x},{default:t(()=>[...a[14]||(a[14]=[d(" Go to Dashboard ",-1)])]),_:1})]),_:1})])):j("",!0)]),_:1})])])]),_:1})],64)}}}),ue=K(te,[["__scopeId","data-v-2b22929f"]]);export{ue as default};
