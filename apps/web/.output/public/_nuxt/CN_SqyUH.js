import{_ as Q}from"./Cv_gb3jg.js";import{g as j,ak as J,r as K,ad as W,p as i,q as _,o as p,w as a,a as o,b as e,d as s,c as g,x as r,I as b,al as w,t as C,H as X,at as Z,n as f,m as d,as as h,_ as tt}from"./DQDUwbr-.js";import{u as et}from"./CI-SnmTa.js";import{u as at}from"./CLh6bXrM.js";const ot={class:"header-inner"},st={class:"nav"},nt={class:"actions"},lt={class:"cart-footer"},rt={class:"cart-total"},it={class:"total-value"},dt={class:"total-value"},ut={key:2,class:"empty-cart"},ct=j({__name:"Header",setup(pt){const I=J(),{user:B,isLoggedIn:k,logout:$}=et(),{items:S,itemCount:x,totalPrice:F,loading:v,isEmpty:L,fetchCart:O,removeFromCart:T,clearCart:V}=at(),u=K(!1);W(k,n=>{n&&O()},{immediate:!0});function A(){$(),u.value=!1}async function H(n){try{await T(n.id),f.success("Item removed from cart")}catch(t){f.error(t?.message||"Failed to remove item")}}async function N(){Z.confirm({title:"Clear Cart?",content:"Are you sure you want to remove all items from your cart?",okText:"Clear",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{await V(),f.success("Cart cleared")}catch(n){f.error(n?.message||"Failed to clear cart")}}})}function R(n){const t=n.titleSnapshot||`Course ${n.courseId}`,l=typeof n.priceSnapshot=="number"?n.priceSnapshot:null;return d("div",{class:"cart-item"},[d("div",{class:"cart-item-main"},[d("div",{class:"cart-item-title"},t),d("div",{class:"cart-item-meta"},[d("span",`Qty: ${n.quantity}`),l!==null?d("span",{class:"cart-price"},` · €${l.toFixed(2)}`):null].filter(Boolean))]),d("div",{class:"cart-item-actions"},[d("a",{class:"cart-action-btn",onClick:()=>H(n),title:"Remove from cart"},[d(h)]),d("a",{class:"cart-action-btn",onClick:()=>{u.value=!1,I.push(`/course/${encodeURIComponent(n.courseId)}`)},title:"View course"},"View")])])}return(n,t)=>{const l=Q,c=i("a-button"),D=i("a-badge"),y=i("a-menu-item"),M=i("a-menu"),q=i("a-dropdown"),E=i("a-spin"),P=i("a-list"),U=i("a-divider"),Y=i("a-space"),z=i("a-drawer"),G=i("a-layout-header");return p(),_(G,{class:"byway-header"},{default:a(()=>[o("div",ot,[e(l,{to:"/",class:"logo"},{default:a(()=>[...t[5]||(t[5]=[o("img",{alt:"Byway",class:"logo-image"},null,-1),o("span",{class:"logo-text"},"Byway",-1)])]),_:1}),o("nav",st,[e(l,{to:"/categories",class:"nav-link","exact-active-class":"nav-active"},{default:a(()=>[...t[6]||(t[6]=[s("Browse",-1)])]),_:1}),e(l,{to:"/course-author",class:"nav-link","exact-active-class":"nav-active"},{default:a(()=>[...t[7]||(t[7]=[s("Teach",-1)])]),_:1}),e(l,{to:"/institutions",class:"nav-link","exact-active-class":"nav-active"},{default:a(()=>[...t[8]||(t[8]=[s("Institutions",-1)])]),_:1}),e(l,{to:"/students",class:"nav-link","exact-active-class":"nav-active"},{default:a(()=>[...t[9]||(t[9]=[s("My Learning",-1)])]),_:1})]),o("div",nt,[r(k)?(p(),g(b,{key:0},[e(D,{count:r(x),"number-style":{backgroundColor:"#52c41a"},offset:[8,0]},{default:a(()=>[e(c,{type:"text",class:"cart-btn",onClick:t[0]||(t[0]=m=>u.value=!0)},{default:a(()=>[e(r(w)),t[10]||(t[10]=o("span",{class:"ml-1"},"Cart",-1))]),_:1})]),_:1},8,["count"]),e(q,{trigger:"click"},{overlay:a(()=>[e(M,null,{default:a(()=>[e(y,null,{default:a(()=>[e(l,{to:"/students"},{default:a(()=>[...t[11]||(t[11]=[s("My Learning",-1)])]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(l,{to:"/cart"},{default:a(()=>[...t[12]||(t[12]=[s("Cart",-1)])]),_:1})]),_:1}),e(y,{onClick:A},{default:a(()=>[...t[13]||(t[13]=[s("Logout",-1)])]),_:1})]),_:1})]),default:a(()=>[e(c,{type:"text",class:"account-btn"},{default:a(()=>[s(C(r(B)?.email||"Account")+" ",1),e(r(X))]),_:1})]),_:1})],64)):(p(),_(l,{key:1,to:"/login"},{default:a(()=>[e(c,{type:"primary",ghost:""},{default:a(()=>[...t[14]||(t[14]=[s("Sign in",-1)])]),_:1})]),_:1}))])]),e(z,{open:u.value,"onUpdate:open":t[4]||(t[4]=m=>u.value=m),title:"Your Cart",placement:"right",width:"420",closable:!0},{default:a(()=>[r(v)?(p(),_(E,{key:0,style:{width:"100%","text-align":"center",padding:"24px"}})):r(L)?(p(),g("div",ut,[e(r(w),{style:{"font-size":"48px",color:"#d9d9d9","margin-bottom":"16px"}}),t[23]||(t[23]=o("div",{class:"empty-text"},"Your cart is empty",-1)),t[24]||(t[24]=o("div",{class:"empty-hint"},"Add courses to get started",-1)),e(l,{to:"/categories"},{default:a(()=>[e(c,{type:"primary",style:{"margin-top":"16px"},onClick:t[3]||(t[3]=m=>u.value=!1)},{default:a(()=>[...t[22]||(t[22]=[s(" Browse Courses ",-1)])]),_:1})]),_:1})])):(p(),g(b,{key:1},[e(P,{"data-source":r(S),renderItem:R,loading:r(v)},null,8,["data-source","loading"]),e(U),o("div",lt,[o("div",rt,[o("div",null,[t[15]||(t[15]=o("span",{class:"total-label"},"Items:",-1)),t[16]||(t[16]=s()),o("span",it,C(r(x)),1)]),o("div",null,[t[17]||(t[17]=o("span",{class:"total-label"},"Subtotal:",-1)),t[18]||(t[18]=s()),o("span",dt,"€"+C(r(F).toFixed(2)),1)])]),e(Y,{style:{width:"100%","margin-top":"12px"}},{default:a(()=>[e(c,{block:"",onClick:N,loading:r(v)},{default:a(()=>[...t[19]||(t[19]=[s(" Clear Cart ",-1)])]),_:1},8,["loading"]),e(l,{to:"/cart",style:{flex:"1"}},{default:a(()=>[e(c,{type:"primary",block:"",onClick:t[1]||(t[1]=m=>u.value=!1)},{default:a(()=>[...t[20]||(t[20]=[s(" Go to Cart ",-1)])]),_:1})]),_:1})]),_:1}),e(l,{to:"/cart",style:{width:"100%",display:"block","margin-top":"8px"}},{default:a(()=>[e(c,{type:"primary",block:"",danger:"",onClick:t[2]||(t[2]=m=>u.value=!1)},{default:a(()=>[...t[21]||(t[21]=[s(" Proceed to checkout ",-1)])]),_:1})]),_:1})])],64))]),_:1},8,["open"])]),_:1})}}}),_t=tt(ct,[["__scopeId","data-v-6fb9db81"]]);export{_t as H};
