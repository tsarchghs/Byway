import{g as A,r as b,l as c,k as B,c as m,b as n,w as i,n as C,p as o,o as r,a as l,d as g,t as _,q as y}from"./DQDUwbr-.js";const N={class:"p-4"},F={class:"text-sm text-gray-700"},P={key:0},T={key:1,class:"text-xs text-gray-500"},U=A({__name:"index",setup(L){const d=b(!1),s=b([]),f=[{title:"Challenge",dataIndex:"challengeTitle",key:"challengeTitle"},{title:"Student",dataIndex:"sessionUserId",key:"student"},{title:"Status",dataIndex:"status",key:"status"},{title:"Grade %",dataIndex:"gradePct",key:"gradePct"},{title:"Bindings",dataIndex:"bindings",key:"bindings"},{title:"Submitted",dataIndex:"createdAtFormatted",key:"createdAt"}],x=c(()=>new Set(s.value.map(e=>e.sessionUserId)).size),p=c(()=>{const a=s.value.filter(t=>typeof t.gradePct=="number");if(!a.length)return null;const e=a.reduce((t,u)=>t+(u.gradePct||0),0);return Math.round(e/a.length*10)/10});async function h(){d.value=!0;try{const a=await fetch("/api/teacher-course-lab/teacher/submissions"),e=await a.json();if(!a.ok)throw new Error(e?.error||"Failed to load lab submissions");s.value=(e.items||[]).map(t=>({...t,bindings:[t.courseId,t.moduleId,t.lessonId].filter(Boolean).join(" / "),createdAtFormatted:t.createdAt?new Date(t.createdAt).toLocaleString():""}))}catch(a){console.error(a),C.error(a?.message||"Failed to load lab submissions")}finally{d.value=!1}}const k=c(()=>s.value.length>0);return B(h),(a,e)=>{const t=o("a-page-header"),u=o("a-card"),v=o("a-col"),I=o("a-empty"),S=o("a-table"),w=o("a-row");return r(),m("div",N,[n(t,{title:"Labs Overview","sub-title":"Monitor CS50-style labs across your courses"}),n(w,{gutter:16},{default:i(()=>[n(v,{xs:24,md:8},{default:i(()=>[n(u,null,{default:i(()=>[l("div",F,[l("div",null,[e[0]||(e[0]=l("strong",null,"Total submissions:",-1)),g(" "+_(s.value.length),1)]),l("div",null,[e[1]||(e[1]=l("strong",null,"Unique students:",-1)),g(" "+_(x.value),1)]),p.value!==null?(r(),m("div",P,[e[2]||(e[2]=l("strong",null,"Average grade:",-1)),g(" "+_(p.value)+"% ",1)])):(r(),m("div",T," No graded submissions yet. "))])]),_:1})]),_:1}),n(v,{xs:24,md:16},{default:i(()=>[n(u,{title:"Latest lab submissions",loading:d.value},{default:i(()=>[!d.value&&!k.value?(r(),y(I,{key:0,description:"No lab submissions yet."})):(r(),y(S,{key:1,columns:f,"data-source":s.value,loading:d.value,"row-key":"id",size:"small"},null,8,["data-source","loading"]))]),_:1},8,["loading"])]),_:1})]),_:1})])}}});export{U as default};
