# ğŸ§© GITHUB COPILOT MASTER PROMPT â€” BYWAY ISOLATED PLUGIN SYSTEM

You are coding inside **Byway**, a modular plugin-based learning platform.

## ğŸ”’ Core Principles

1. **Plugin Isolation**
   - Every plugin has its own Prisma schema, generated client, and DB file.
   - Never import another pluginâ€™s Prisma client or schema.
   - Never perform Prisma joins across plugins.
   - Each pluginâ€™s data access stays inside its own `/server/db` folder.

2. **Cross-plugin Communication**
   - Plugins talk to each other strictly through **HTTP or GraphQL APIs**.
   - Example âœ… `await $fetch('/api/teach/courses/' + courseId)`
   - Example âŒ `import { PrismaClient } from '../../teach/server/db/generated/client'`
   - All â€œrelationsâ€ across plugins are expressed as API requests and verified in the service layer.

3. **Business Logic Integrity**
   - Enforce production-grade business rules through resolvers, not Prisma foreign keys:
     - If a user is enrolled â†’ they canâ€™t add that course to cart.
     - If an order is paid â†’ create an enrollment automatically.
     - If a teacher isnâ€™t verified â†’ block publishing.
   - All these checks happen in GraphQL mutations or REST routes.

4. **Prisma Schema Discipline**
   - Each plugin models foreign entities by `id` only (`studentId`, `courseId`, etc.).
   - Never add real foreign keys to another pluginâ€™s DB.
   - Always include `createdAt`, `updatedAt`, and relevant status enums.

5. **GraphQL + API Rules**
   - Use Nexus `objectType`, `mutationField`, `queryField` conventions.
   - Donâ€™t leak raw Prisma types â€” explicitly map fields.
   - Fetch related data through API calls or remote resolvers.
   - Always validate input and throw clear errors.

6. **Production Mindset**
   - Each plugin exposes:
     - `/server/graphql/` â†’ GraphQL types & resolvers
     - `/server/api/` â†’ REST endpoints for other plugins
     - `/nuxt/` â†’ Client pages and components
   - Use Ant Design Vue for UI.
   - All async operations must be safe, validated, and idempotent.

7. **Global Coordination**
   - The **core orchestrator** dynamically loads plugins and registers their GraphQL endpoints.
   - Shared entities (User, Auth, Session) live only in `authentication`, and are queried over APIs.

## ğŸ§© Copilot Instruction Mode
Whenever asked to build, connect, or refactor models:
- Keep all Prisma operations scoped to the current plugin.
- Express inter-plugin â€œrelationsâ€ through API contracts.
- Add business rules enforcing common-sense consistency.
- Ensure schema fields reflect those logical relations with IDs and status fields.
- Generate TypeScript + Nexus GraphQL + REST/Fetch logic in a production-ready style.

## ğŸ§  Golden Rule
> â€œEach plugin is its own service. Relations exist only through APIs â€” not Prisma joins.â€

---
# ğŸš€ YOUR NEXT PROMPT BELOW THIS LINE